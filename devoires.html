<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ÙØ±ÙˆØ¶ Bac</title>
<style>
body{font-family:sans-serif;margin:0;padding:0;background:#f4f4f4}
header{background:#222;color:#fff;padding:1rem;text-align:center}
.container{max-width:1200px;margin:auto;padding:1rem}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin-top:1rem}
.card{background:#fff;padding:1rem;border-radius:8px;text-align:center;cursor:pointer;box-shadow:0 2px 5px rgba(0,0,0,0.1)}
.devoirs-list{margin-top:1rem;display:none}
.devoirs-list.active{display:block}
.devoir-item{background:#fff;padding:0.8rem;margin:0.5rem 0;border-radius:5px;box-shadow:0 1px 3px rgba(0,0,0,0.1)}
button,a{margin:0.2rem;padding:0.4rem 0.8rem;border:none;border-radius:5px;text-decoration:none;cursor:pointer}
button{background:#007bff;color:#fff}
a{background:#28a745;color:#fff}
#searchBox{width:100%;padding:0.6rem;margin:1rem 0;border-radius:5px;border:1px solid #ccc}
.filter-section{margin:1rem 0;text-align:center}
.filter-section select{padding:0.4rem;margin:0.2rem;border-radius:5px;border:1px solid #ccc}
.most-downloaded{margin:1rem 0;padding:0.5rem;background:#ffc107;color:#000;border-radius:5px;text-align:center}
</style>
<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>

<header>
<h1>ğŸ“ ÙØ±ÙˆØ¶ Bac</h1>
</header>

<main class="container">

<input type="text" id="searchBox" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ù…Ø¨Ø§Ø´Ø±Ø© Ø¨Ø§Ø³Ù… Ø§Ù„ÙØ±Ø¶...">

<div class="filter-section">
<select id="filterYear">
  <option value="">Ø§Ù„ÙƒÙ„ Ø­Ø³Ø¨ Ø§Ù„Ø³Ù†Ø©</option>
  <option value="1ere">1Ã¨re</option>
  <option value="2nde">2nde</option>
</select>
<select id="filterSubject">
  <option value="">Ø§Ù„ÙƒÙ„ Ø­Ø³Ø¨ Ø§Ù„Ù…Ø§Ø¯Ø©</option>
  <option value="maths">Ø±ÙŠØ§Ø¶ÙŠØ§Øª</option>
  <option value="tech">ØªÙ‚Ù†ÙŠØ©</option>
  <option value="info">Ø¥Ø¹Ù„Ø§Ù…ÙŠØ©</option>
  <option value="sciences">Ø¹Ù„ÙˆÙ…</option>
  <option value="eco">Ø§Ù‚ØªØµØ§Ø¯ ÙˆØªØµØ±Ù</option>
  <option value="arab">Ø¢Ø¯Ø§Ø¨</option>
</select>
</div>

<div class="most-downloaded" id="mostDownloaded">â­ Ø§Ù„Ø£ÙƒØ«Ø± ØªØ­Ù…ÙŠÙ„Ø§Ù‹: -</div>

<div class="grid" id="sectionsGrid">
  <div class="card" onclick="showDevoirs('tech')">âš™ï¸ ØªÙ‚Ù†ÙŠØ©</div>
  <div class="card" onclick="showDevoirs('maths')">ğŸ“ Ø±ÙŠØ§Ø¶ÙŠØ§Øª</div>
  <div class="card" onclick="showDevoirs('info')">ğŸ’» Ø¥Ø¹Ù„Ø§Ù…ÙŠØ©</div>
  <div class="card" onclick="showDevoirs('sciences')">ğŸ§ª Ø¹Ù„ÙˆÙ…</div>
  <div class="card" onclick="showDevoirs('eco')">ğŸ“Š Ø§Ù‚ØªØµØ§Ø¯ ÙˆØªØµØ±Ù</div>
  <div class="card" onclick="showDevoirs('arab')">ğŸ“– Ø¢Ø¯Ø§Ø¨</div>
</div>

<!-- Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„ÙØ±ÙˆØ¶ Ù„ÙƒÙ„ Ø´Ø¹Ø¨Ø© -->
<div id="tech" class="devoirs-list"></div>
<div id="maths" class="devoirs-list"></div>
<div id="info" class="devoirs-list"></div>
<div id="sciences" class="devoirs-list"></div>
<div id="eco" class="devoirs-list"></div>
<div id="arab" class="devoirs-list"></div>

</main>

<script>
// Firebase config
const firebaseConfig = {
  apiKey: "FAKE-KEY",
  authDomain: "fake.firebaseapp.com",
  databaseURL: "https://fake-default-rtdb.firebaseio.com",
  projectId: "fake",
  storageBucket: "fake.appspot.com",
  messagingSenderId: "123",
  appId: "1:123:web:abc"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±ÙˆØ¶ Ù…Ø¹ Ø§Ù„Ø³Ù†Ø© ÙˆØ§Ù„Ù…Ø§Ø¯Ø©
const data = {
  tech:Array.from({length:10},(_,i)=>({title:`ØªÙ‚Ù†ÙŠØ© ${i+1}`,file:`devoirs/tech/devoir-${i+1}.pdf`,year:i%2===0?"1ere":"2nde",subject:"tech",downloads:0 })),
  maths:Array.from({length:10},(_,i)=>({title:`Ø±ÙŠØ§Ø¶ÙŠØ§Øª ${i+1}`,file:`devoirs/maths/devoir-${i+1}.pdf`,year:i%2===0?"1ere":"2nde",subject:"maths",downloads:0 })),
  info:Array.from({length:10},(_,i)=>({title:`Ø¥Ø¹Ù„Ø§Ù…ÙŠØ© ${i+1}`,file:`devoirs/info/devoir-${i+1}.pdf`,year:i%2===0?"1ere":"2nde",subject:"info",downloads:0 })),
  sciences:Array.from({length:10},(_,i)=>({title:`Ø¹Ù„ÙˆÙ… ${i+1}`,file:`devoirs/sciences/devoir-${i+1}.pdf`,year:i%2===0?"1ere":"2nde",subject:"sciences",downloads:0 })),
  eco:Array.from({length:10},(_,i)=>({title:`Ø§Ù‚ØªØµØ§Ø¯ ${i+1}`,file:`devoirs/eco/devoir-${i+1}.pdf`,year:i%2===0?"1ere":"2nde",subject:"eco",downloads:0 })),
  arab:Array.from({length:10},(_,i)=>({title:`Ø¢Ø¯Ø§Ø¨ ${i+1}`,file:`devoirs/arab/devoir-${i+1}.pdf`,year:i%2===0?"1ere":"2nde",subject:"arab",downloads:0 }))
};

function updateMostDownloaded(){
  let all = Object.values(data).flat();
  all.sort((a,b)=>b.downloads-a.downloads);
  document.getElementById("mostDownloaded").innerText=`â­ Ø§Ù„Ø£ÙƒØ«Ø± ØªØ­Ù…ÙŠÙ„Ø§Ù‹: ${all[0].title} (${all[0].downloads})`;
}

function showDevoirs(section){
  document.querySelectorAll('.devoirs-list').forEach(div=>div.classList.remove('active'));
  const container = document.getElementById(section);
  if(container.innerHTML===""){
    data[section].forEach((d,i)=>{
      const div = document.createElement('div');
      div.className="devoir-item";
      div.innerHTML=`<h3>${d.title}</h3>
        <p>Ø§Ù„Ø³Ù†Ø©: ${d.year} | Ø§Ù„Ù…Ø§Ø¯Ø©: ${d.subject}</p>
        <a href="${d.file}" target="_blank" onclick="incrementDownload('${section}',${i})">ğŸ“¥ ØªØ­Ù…ÙŠÙ„</a>`;
      container.appendChild(div);
    });
  }
  container.classList.add('active');
  filterDevoirs();
}

function incrementDownload(section,index){
  data[section][index].downloads++;
  updateMostDownloaded();
  // Firebase
  db.ref(`downloads/${section}/devoir-${index+1}`).set(data[section][index].downloads);
}

function filterDevoirs(){
  const year = document.getElementById("filterYear").value;
  const subject = document.getElementById("filterSubject").value;
  document.querySelectorAll('.devoirs-list.active .devoir-item').forEach(div=>{
    const text = div.innerText;
    let show=true;
    if(year && !text.includes(year)) show=false;
    if(subject && !text.includes(subject)) show=false;
    div.style.display=show?"block":"none";
  });
}

// Ø¨Ø­Ø« Ù…Ø¨Ø§Ø´Ø±
document.getElementById("searchBox").addEventListener("input",e=>{
  const val = e.target.value.toLowerCase();
  document.querySelectorAll('.devoirs-list.active .devoir-item').forEach(div=>{
    div.style.display = div.innerText.toLowerCase().includes(val)?"block":"none";
  });
});

document.getElementById("filterYear").addEventListener("change",filterDevoirs);
document.getElementById("filterSubject").addEventListener("change",filterDevoirs);
updateMostDownloaded();
</script>

</body>
</html>
