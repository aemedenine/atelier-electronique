<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Atelier Electronique Médenine</title>

<!-- ===== Fonts ===== -->
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">

<!-- ===== Firebase SDK ===== -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
/* ===== GLOBAL ===== */
body{margin:0;font-family:Montserrat;background:#0b0b0b;color:#fff}
.container{max-width:1200px;margin:auto;padding:15px}
button{cursor:pointer}

/* ===== HEADER ===== */
.header-inner{position:relative;text-align:center}
#pcbCanvas{position:absolute;top:0;left:0;width:100%;height:100%}
.logo{width:90px;z-index:2;position:relative}
#site-name{z-index:2;position:relative}

/* ===== INFO BAR ===== */
.info-bar{display:flex;gap:15px;justify-content:center;align-items:center}

/* ===== BUTTONS ===== */
.cta-buttons{display:flex;flex-wrap:wrap;gap:10px;justify-content:center}
.cta-buttons a, .cta-buttons button{
background:#ff6b35;border:none;padding:10px 15px;
border-radius:8px;color:#fff;text-decoration:none;
transition:0.3s
}
.cta-buttons a:hover, .cta-buttons button:hover{opacity:0.8}

/* ===== WEATHER ===== */
.weather-box{margin:30px auto;max-width:420px;padding:15px;
background:rgba(255,255,255,.08);border-radius:15px;text-align:center}

/* ===== SERVICES ===== */
.services-slider{display:flex;gap:15px;overflow-x:auto;cursor:grab}
.service-card{min-width:220px;background:rgba(255,255,255,.08);
border-radius:15px;padding:10px}
.service-card img, .service-card video{width:100%;border-radius:10px}

/* ===== RATING ===== */
.stars span{font-size:2rem;cursor:pointer;transition:0.2s}
.stars span:hover{color:#ff6b35}

/* ===== LOGIN POPUP ===== */
#login-popup{position:fixed;inset:0;background:rgba(0,0,0,.8);
display:none;justify-content:center;align-items:center;z-index:999}
.popup{background:#111;padding:25px;border-radius:12px;text-align:center}

/* ===== CMP ===== */
#cmp{position:fixed;bottom:0;width:100%;background:#000;padding:10px;text-align:center}

/* ===== FULLSCREEN ===== */
#viewer{position:fixed;inset:0;background:#000;display:none;
justify-content:center;align-items:center;z-index:9999}
#viewer img,#viewer video{max-width:90%;max-height:90%}

/* ===== RADIO & OPTIONS ===== */
.option-group{display:flex;gap:10px;justify-content:center;margin:15px 0}
.option-group input[type="radio"]{margin-left:5px}
</style>
</head>

<body>

<header class="container header-inner">
  <canvas id="pcbCanvas"></canvas>
  <img src="logo.png" class="logo">
  <h1 id="site-name">Atelier Electronique Médenine</h1>
</header>

<div class="container info-bar">
  <div id="visit-count">0</div>
  <button id="lang-btn">AR / FR</button>
</div>

<section class="cta-buttons container">
  <a href="#">تحميل البرامج</a>
  <a href="#">الصور</a>
  <a href="#">الفيديو</a>
  <button id="login-btn">Login</button>
</section>

<!-- ===== OPTIONS / RADIO EXAMPLE ===== -->
<section class="container">
  <div class="option-group">
    <label><input type="radio" name="opt" value="1"> خيار 1</label>
    <label><input type="radio" name="opt" value="2"> خيار 2</label>
    <label><input type="radio" name="opt" value="3"> خيار 3</label>
  </div>
</section>

<section class="weather-box">
  <h3 id="weather-title"></h3>
  <div id="weather-temp"></div>
  <div id="weather-desc"></div>
  <div id="prayer-times"></div>
</section>

<section class="container">
  <h2 id="services-title"></h2>
  <div class="services-slider" id="services">
    <div class="service-card"><img src="service1.webp"><p></p></div>
    <div class="service-card"><img src="service2.webp"><p></p></div>
    <div class="service-card"><img src="service3.webp"><p></p></div>
  </div>
</section>

<section class="container rating">
  <p id="rating-title"></p>
  <div class="stars">
    <span data-v="1">☆</span>
    <span data-v="2">☆</span>
    <span data-v="3">☆</span>
    <span data-v="4">☆</span>
    <span data-v="5">☆</span>
  </div>
</section>

<!-- ===== LOGIN ===== -->
<div id="login-popup">
  <div class="popup">
    <h3 id="login-title"></h3>
    <button id="google-btn">Google</button><br><br>
    <button onclick="toggleLogin(false)">Close</button>
  </div>
</div>

<!-- ===== CMP ===== -->
<div id="cmp">
  <span id="cmp-text"></span>
  <button id="cmp-ok">OK</button>
</div>

<!-- ===== FULLSCREEN VIEWER ===== -->
<div id="viewer" onclick="closeViewer()">
  <img id="viewer-img">
  <video id="viewer-video" controls></video>
</div>

<script>
/* ===== GLOBAL STATE ===== */
let lang = 'ar';

/* ===== TRANSLATIONS ===== */
const T = {
 ar:{
  weather:"حالة الطقس في مدنين",
  services:"خدمات اليوم",
  rating:"قيم الورشة",
  login:"تسجيل الدخول",
  cmp:"نستخدم الكوكيز لتحسين تجربتك",
  servicesTxt:["تصليح لوحات","تصليح كارت","صيانة إلكترونية"],
  optionTxt:["خيار 1","خيار 2","خيار 3"]
 },
 fr:{
  weather:"Météo à Médenine",
  services:"Services du jour",
  rating:"Évaluer l'atelier",
  login:"Connexion",
  cmp:"Nous utilisons des cookies",
  servicesTxt:["Réparation cartes","Réparation carte","Maintenance"],
  optionTxt:["Option 1","Option 2","Option 3"]
 }
};

/* ===== FIREBASE ===== */
firebase.initializeApp({
 apiKey:"AIzaSy...",
 authDomain:"atelier-electronique-mednine.firebaseapp.com",
 databaseURL:"https://atelier-electronique-mednine-default-rtdb.firebaseio.com"
});
const auth=firebase.auth();
const db=firebase.database();

/* ===== VISITS COUNTER ===== */
const ref=db.ref("visits");
ref.transaction(v=>(v||0)+1);
ref.on("value",s=>{
 document.getElementById("visit-count").textContent=
 (lang==='ar'?'عدد الزوار: ':'Visiteurs: ')+(s.val()||0);
});

/* ===== LANGUAGE SWITCH ===== */
function applyLang(){
 document.getElementById("weather-title").textContent=T[lang].weather;
 document.getElementById("services-title").textContent=T[lang].services;
 document.getElementById("rating-title").textContent=T[lang].rating;
 document.getElementById("login-title").textContent=T[lang].login;
 document.getElementById("cmp-text").textContent=T[lang].cmp;
 document.querySelectorAll(".service-card p")
 .forEach((p,i)=>p.textContent=T[lang].servicesTxt[i]);
 document.querySelectorAll(".option-group label").forEach((l,i)=>l.childNodes[1].textContent=T[lang].optionTxt[i]);
}

/* ===== WEATHER ===== */
fetch("https://api.open-meteo.com/v1/forecast?latitude=33.35&longitude=10.5&current_weather=true")
.then(r=>r.json()).then(d=>{
 document.getElementById("weather-temp").textContent=d.current_weather.temperature+"°C";
});

/* ===== PRAYER TIMES ===== */
fetch("https://api.aladhan.com/v1/timingsByCity?city=Medenine&country=Tunisia")
.then(r=>r.json()).then(d=>{
 const t=d.data.timings;
 document.getElementById("prayer-times").innerHTML=
 `Fajr ${t.Fajr} | Dhuhr ${t.Dhuhr} | Maghrib ${t.Maghrib}`;
});

/* ===== RATING ===== */
document.querySelectorAll(".stars span").forEach(s=>{
 s.onclick=()=>{
  localStorage.setItem("rating",s.dataset.v);
 };
});

/* ===== LOGIN ===== */
function toggleLogin(v){document.getElementById("login-popup").style.display=v?'flex':'none'}
document.getElementById("login-btn").onclick=()=>toggleLogin(true);
document.getElementById("google-btn").onclick=()=>{
 auth.signInWithPopup(new firebase.auth.GoogleAuthProvider())
 .then(()=>toggleLogin(false));
};

/* ===== CMP ===== */
if(localStorage.getItem("cmp"))document.getElementById("cmp").style.display="none";
document.getElementById("cmp-ok").onclick=()=>{
 localStorage.setItem("cmp",1);
 document.getElementById("cmp").style.display="none";
};

/* ===== LANGUAGE BUTTON ===== */
document.getElementById("lang-btn").onclick=()=>{
 lang=lang==='ar'?'fr':'ar';
 applyLang();
};

/* ===== FULLSCREEN VIEWER ===== */
function closeViewer(){
 document.getElementById("viewer").style.display="none";
 document.getElementById("viewer-img").src="";
 document.getElementById("viewer-video").src="";
}

/* ===== INIT ===== */
applyLang();
</script>

</body>
</html>
