<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>๐ ููุชุจุฉ ูุฑูุถ ุงูุจูุงููุฑูุง</title>
  <link rel="stylesheet" href="style.css">
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>

<header>
  <div class="container header-inner">
    <img src="logo.png" class="logo">
    <h1>๐ ููุชุจุฉ ูุฑูุถ ุงูุจูุงููุฑูุง</h1>
  </div>
</header>

<main class="container">

<section class="projects-section">

  <div class="project-box">
    <h2 id="page-title">ุงุฎุชุฑ ุงูุดุนุจุฉ</h2>
    <p class="box-desc">ุงุถุบุท ุนูู ุงูุดุนุจุฉ ูุนุฑุถ ุฌููุน ุงููุฑูุถ</p>

    <div class="projects-grid" id="sectionsGrid">

      <div class="project-card" onclick="openSection('technique')"><h3>โ๏ธ ุชูููุฉ</h3></div>
      <div class="project-card" onclick="openSection('informatique')"><h3>๐ป ุฅุนูุงููุฉ</h3></div>
      <div class="project-card" onclick="openSection('maths')"><h3>๐ ุฑูุงุถูุงุช</h3></div>
      <div class="project-card" onclick="openSection('sciences')"><h3>๐งช ุนููู</h3></div>
      <div class="project-card" onclick="openSection('eco_gestion')"><h3>๐ ุงูุชุตุงุฏ ูุชุตุฑู</h3></div>
      <div class="project-card" onclick="openSection('arabia')"><h3>๐ ุขุฏุงุจ</h3></div>

    </div>

  </div>

  <!-- ๐ ุจุญุซ -->
  <div class="search-box">
    <input type="text" id="searchInput" placeholder="๐ ุงุจุญุซ ุนู ุงููุฑุถ ุฃู ุงูุณูุฉ...">
  </div>

  <!-- ๐๏ธ Container for filtered devoirs -->
  <div class="projects-grid" id="devoirsGrid"></div>

</section>

</main>

<script>
  // ================= Firebase Config =================
  const firebaseConfig = {
    apiKey: "AIzaSy...YOUR_API_KEY",
    authDomain: "your-app.firebaseapp.com",
    databaseURL: "https://your-app-default-rtdb.firebaseio.com",
    projectId: "your-app",
    storageBucket: "your-app.appspot.com",
    messagingSenderId: "123456789",
    appId: "1:123456789:web:abc123"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // ================= ุจูุงูุงุช ูู ุงููุฑูุถ =================
  const data = {
    maths: Array.from({length:10}, (_,i)=>({title:`ุฑูุงุถูุงุช 2023-${i+1}`, year:2023, file:`devoires/maths/maths-${i+1}.pdf`, downloads:0})),
    informatique: Array.from({length:10}, (_,i)=>({title:`Algorithmique 2023-${i+1}`, year:2023, file:`devoires/informatique/algo-${i+1}.pdf`, downloads:0})),
    technique: Array.from({length:10}, (_,i)=>({title:`ุงููุชุฑูููุงุช 2023-${i+1}`, year:2023, file:`devoires/technique/electronique-${i+1}.pdf`, downloads:0})),
    sciences: Array.from({length:10}, (_,i)=>({title:`ุนููู ุทุจูุนูุฉ 2023-${i+1}`, year:2023, file:`devoires/sciences/svt-${i+1}.pdf`, downloads:0})),
    eco_gestion: Array.from({length:10}, (_,i)=>({title:`ุงูุชุตุงุฏ 2023-${i+1}`, year:2023, file:`devoires/eco_gestion/eco-${i+1}.pdf`, downloads:0})),
    arabia: Array.from({length:10}, (_,i)=>({title:`ููุณูุฉ 2023-${i+1}`, year:2023, file:`devoires/arabia/philo-${i+1}.pdf`, downloads:0}))
  };

  // ================= ุงุฎุชูุงุฑ ุงูุดุนุจุฉ =================
  function openSection(sec){
    window.location.href = "devoires.html?section=" + sec;
  }

  const params = new URLSearchParams(window.location.search);
  const section = params.get("section");

  if(section) loadDevoirs(section);

  function loadDevoirs(sec){
    document.getElementById("page-title").innerHTML = "๐ ูุฑูุถ ุดุนุจุฉ " + sec;
    const grid = document.getElementById("devoirsGrid");
    grid.innerHTML = "";

    data[sec].forEach((d, idx) => {
      const card = document.createElement("div");
      card.classList.add("project-card");
      card.innerHTML = `
        <h3>${d.title} (${d.year})</h3>
        <button class="download-btn" onclick="viewPDF('${sec}',${idx})">๐๏ธ ูุดุงูุฏุฉ</button>
        <a href="${d.file}" download class="download-btn" onclick="incrementDownload('${sec}',${idx})">๐ฅ ุชุญููู</a>
        <small>โญ ${d.downloads} ุชุญูููุงุช</small>
      `;
      grid.appendChild(card);
    });
  }

  // ================= ูุดุงูุฏุฉ PDF =================
  function viewPDF(sec, idx){
    const file = data[sec][idx].file;
    window.open(file, "_blank");
  }

  // ================= ุชุญููู + Firebase compteur =================
  function incrementDownload(sec, idx){
    data[sec][idx].downloads++;
    const path = `downloads/${sec}-${idx}`;
    db.ref(path).set(data[sec][idx].downloads);
    loadDevoirs(sec);
  }

  // ================= ุจุญุซ ูุจุงุดุฑ =================
  const searchInput = document.getElementById("searchInput");
  searchInput.addEventListener("input", () => {
    const val = searchInput.value.toLowerCase();
    const filtered = data[section].filter(d => d.title.toLowerCase().includes(val) || d.year.toString().includes(val));
    const grid = document.getElementById("devoirsGrid");
    grid.innerHTML = "";
    filtered.forEach((d, idx) => {
      const card = document.createElement("div");
      card.classList.add("project-card");
      card.innerHTML = `
        <h3>${d.title} (${d.year})</h3>
        <button class="download-btn" onclick="viewPDF('${section}',${idx})">๐๏ธ ูุดุงูุฏุฉ</button>
        <a href="${d.file}" download class="download-btn" onclick="incrementDownload('${section}',${idx})">๐ฅ ุชุญููู</a>
        <small>โญ ${d.downloads} ุชุญูููุงุช</small>
      `;
      grid.appendChild(card);
    });
  });

</script>

</body>
</html>
