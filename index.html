<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Atelier Electronique MÃ©denine</title>

<!-- Google AdSense -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5360225987687639" crossorigin="anonymous"></script>

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Open+Sans:wght@400;700&display=swap" rel="stylesheet">

<!-- CSS -->
<link rel="stylesheet" href="style.css" />

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-analytics-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
  // ======= Firebase Configuration =======
  const firebaseConfig = {
    apiKey: "AIzaSyCtbEWdm7CAC25ROslGlVeLOvfxdi2exVo",
    authDomain: "atelier-electronique-mednine.firebaseapp.com",
    projectId: "atelier-electronique-mednine",
    storageBucket: "atelier-electronique-mednine.appspot.com",
    messagingSenderId: "547430908384",
    appId: "1:547430908384:web:4caa4cf3869491bd14eb85"
  };

  const app = firebase.initializeApp(firebaseConfig);
  const analytics = firebase.analytics(app);
  const auth = firebase.auth();
  const db = firebase.database();

  // ======= Persistence Login =======
  firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL)
    .then(() => console.log("ğŸ”’ Session persistente activÃ©e"))
    .catch(error => console.error("Erreur persistence:", error));
</script>

<style>
  /* ======= General Styles ======= */
  body { margin:0; font-family:'Montserrat', sans-serif; background:#0a0a0a; color:#fff; }
  a { text-decoration:none; color:inherit; }

  .container { width:90%; max-width:1200px; margin:0 auto; }

  /* ======= Header ======= */
  header { position:relative; }
  .header-inner { position: relative; overflow: hidden; height:150px; display:flex; align-items:center; padding:10px 0; }
  #pcbCanvasHeader { position:absolute; top:0; left:0; width:100%; height:100%; z-index:0; }
  .header-inner img, .header-inner h1 { position:relative; z-index:10; margin:0 15px; }
  h1#site-name { font-size:1.8rem; transition: color 0.5s, transform 0.5s, text-shadow 0.5s; }

  .news-ticker { background:#111; overflow:hidden; white-space:nowrap; padding:5px 0; font-size:1rem; color:#0ff; }

  /* ======= Main Content ======= */
  main { margin-top:20px; }

  /* Info Bar */
  .info-bar { display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; }
  #current-time, #visit-count { font-size:1rem; }
  #toggle-lang-btn { background:#ff6b35; border:none; color:#fff; padding:8px 15px; border-radius:5px; cursor:pointer; font-weight:bold; }

  /* ======= User Info ======= */
  .user-box { display:flex; justify-content:space-between; align-items:center; background:rgba(0,255,255,0.1); backdrop-filter:blur(6px); border:2px solid #0ff; border-radius:12px; padding:12px 20px; max-width:400px; margin:20px auto; color:#fff; box-shadow:0 0 15px rgba(0,255,255,0.4); }
  .welcome-msg { font-size:1.1rem; font-weight:600; color:#0ff; text-shadow:0 0 6px #0ff; }
  .btn-signout { background:#ff6b35; color:#fff; border:none; padding:8px 18px; border-radius:8px; cursor:pointer; font-weight:600; transition:all 0.3s ease; }
  .btn-signout:hover { background:#e05520; transform:translateY(-2px); box-shadow:0 0 10px #ff6b35; }

  /* ======= Login Popup ======= */
  #login-popup { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); justify-content:center; align-items:center; z-index:10000; flex-direction:column; }
  #login-popup .popup-content { background:#111; padding:30px 25px; border-radius:15px; text-align:center; color:#fff; width:320px; max-width:90%; box-shadow:0 0 25px #0ff; animation:fadeIn 0.5s ease; }
  #login-popup h2 { font-size:1.5rem; margin-bottom:20px; color:#0ff; text-shadow:0 0 10px #0ff; }
  #btn-google { background:#0ff; color:#000; border:none; padding:10px 20px; border-radius:8px; font-weight:600; cursor:pointer; width:100%; margin-bottom:10px; transition:all 0.3s ease; }
  #btn-google:hover { background:#00cdd7; transform:translateY(-2px); box-shadow:0 0 12px #0ff; }
  #btn-close-popup { background:#ff6b35; color:#fff; border:none; padding:8px 20px; border-radius:8px; font-weight:600; cursor:pointer; width:100%; transition:all 0.3s ease; }
  #btn-close-popup:hover { background:#e05520; transform:translateY(-2px); box-shadow:0 0 10px #ff6b35; }

  @keyframes fadeIn { from{opacity:0} to{opacity:1} }

  /* ======= CTA Buttons ======= */
  .cta-buttons { display:flex; flex-wrap:wrap; gap:10px; justify-content:center; margin:30px 0; }
  .cta-buttons a, .cta-buttons button { background:#0ff; color:#000; border:none; padding:10px 15px; border-radius:8px; cursor:pointer; font-weight:bold; transition:all 0.3s ease; }
  .cta-buttons a:hover, .cta-buttons button:hover { box-shadow:0 0 15px #ff6b35, 0 0 30px #ff6b35; transform:translateY(-3px); }

  /* ======= Experience Badge ======= */
  .experience-badge { display:block; text-align:center; font-size:1.3rem; font-weight:bold; color:yellow; margin:30px auto; background:none; padding:0; animation:glowExperience 1.5s infinite alternate, floatExperience 3s ease-in-out infinite; }
  @keyframes glowExperience { 0%{color:yellow;text-shadow:0 0 5px yellow;}25%{color:red;text-shadow:0 0 8px red;}50%{color:cyan;text-shadow:0 0 10px cyan;}75%{color:magenta;text-shadow:0 0 12px magenta;}100%{color:yellow;text-shadow:0 0 15px yellow;} }
  @keyframes floatExperience {0%{transform:translateY(0);}50%{transform:translateY(-6px);}100%{transform:translateY(0);}}

  /* ======= Weather Box ======= */
  .weather-box { margin:40px auto 10px; padding:20px; max-width:420px; background:rgba(255,255,255,0.08); backdrop-filter:blur(8px); border-radius:15px; text-align:center; color:#fff; box-shadow:0 0 20px rgba(0,255,255,0.2); }
  .weather-box h3 { margin-bottom:10px; color:#0ff; }
  .weather-temp { font-size:2.5rem; font-weight:bold; margin:10px 0; }
  .weather-desc { font-size:1.1rem; opacity:0.9; }
  .prayer-times p { display:flex; justify-content:space-between; margin:3px 0; font-size:1rem; color:#fff; }
  .prayer-times p span { flex-shrink:0; }
  .prayer-times p .time { font-weight:bold; }

  /* ======= Ratings ======= */
  .rating-container { margin:40px auto; text-align:center; color:#fff; }
  .stars-horizontal span { font-size:2.5rem; cursor:pointer; color:#ccc; transition:color 0.3s, transform 0.3s, text-shadow 0.3s; margin:0 5px; display:inline-block; }
  .stars-horizontal span.selected { color:gold; text-shadow:0 0 8px gold; }
  .stars-horizontal span.hover { color:gold; text-shadow:0 0 8px gold; transform:scale(1.4) translateY(-5px); }
  #rating-value { margin-top:10px; font-size:1.2rem; transition: color 0.3s, text-shadow 0.3s, transform 0.3s; }
  .rating-container:hover #rating-value { transform:translateY(-3px); }

  /* ======= Services Today / Videos / Poste Soudure ======= */
  .services-today h2, .videos-today h2, #postesSection h2 { text-align:center; color:#0ff; margin:30px 0; font-size:1.8rem; text-shadow:0 0 8px rgba(0,255,255,0.6); }
  .services-slider { display:flex; gap:20px; overflow-x:auto; padding:10px; cursor:grab; }
  .services-slider::-webkit-scrollbar { display:none; }
  .service-card { min-width:220px; background:rgba(255,255,255,0.08); backdrop-filter:blur(6px); border-radius:15px; padding:10px; box-shadow:0 8px 20px rgba(0,0,0,.35); flex-shrink:0; text-align:center; }
  .service-card img, .service-card video { width:100%; height:140px; object-fit:cover; border-radius:12px; cursor:pointer; }
  .service-card video { height:160px; }
  .service-card p { margin-top:10px; font-weight:bold; color:#fff; text-align:center; }

  /* ======= Footer ======= */
  footer { background:#111; padding:20px 0; text-align:center; font-size:0.9rem; color:#aaa; }
  .social-icons img { width:30px; margin:0 5px; }
</style>
</head>

<body>

<header>
  <div class="container header-inner">
    <canvas id="pcbCanvasHeader"></canvas>
    <img src="logo.png" alt="Logo" class="logo" />
    <h1 id="site-name">Atelier Electronique MÃ©denine</h1>
  </div>
  <div class="news-ticker" aria-live="polite">
    <div class="news-text" id="live-news">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø®Ø¨Ø§Ø±...</div>
  </div>
</header>

<main class="container main-content">

  <!-- Info Bar -->
  <section class="info-bar">
    <div id="current-time">--:--:--</div>
    <div id="visit-count">Ø¹Ø¯Ø¯ Ø²ÙˆØ§Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹: 0</div>
    <button id="toggle-lang-btn">ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù„ØºØ©</button>
  </section>

  <!-- User Info -->
  <div id="user-info" class="user-box" style="display:none;">
    <p class="welcome-msg">Ù…Ø±Ø­Ø¨Ø§ <span id="user-name"></span>! ğŸ‘‹</p>
    <button id="btn-signout" class="btn-signout">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
  </div>

  <!-- Login Popup -->
  <div id="login-popup">
    <div class="popup-content">
      <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
      <button id="btn-google">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù€ Google</button>
      <button id="btn-close-popup">Ø¥Ù„ØºØ§Ø¡</button>
    </div>
  </div>

  <!-- CTA Buttons -->
  <section class="cta-buttons">
    <a href="download">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬ ğŸ“¥</a>
    <a href="store.html">ØªÙØ³ÙˆÙ‘Ù‚ Ø§Ù„Ø¢Ù† ğŸ›’</a>
    <a href="https://wa.me/21698192103" target="_blank" rel="noopener">ÙˆØ§ØªØ³Ø§Ø¨ ğŸ“±</a>
    <a href="https://maps.app.goo.gl/nxBU8h2oFDEkiBFE9" target="_blank" rel="noopener">Ù…ÙˆÙ‚Ø¹Ù†Ø§ Ø¹Ù„Ù‰ Ù…Ø§Ø¨Ø³ ğŸ“</a>
    <a href="photos.html">Ø´Ø§Ù‡Ø¯ Ø§Ù„ØµÙˆØ± ğŸ–¼ï¸</a>
    <a href="videos.html">Ø´Ø§Ù‡Ø¯ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ğŸ¥</a>
    <a href="services.html">Ø®Ø¯Ù…Ø§Øª Ø§Ù„ÙˆØ±Ø´Ø© ğŸ› ï¸</a>
    <button id="radio-btn">Ø´ØºÙ‘Ù„ Ø§Ù„Ø±Ø§Ø¯ÙŠÙˆ ğŸ“»</button>
    <audio id="radio-stream" src="https://stream.radiojar.com/8s5u5tpdtwzuv" preload="none" playsinline></audio>
  </section>

  <!-- Experience -->
  <section class="experience-badge">Ø£ÙƒØ«Ø± Ù…Ù† 10 Ø³Ù†ÙˆØ§Øª Ø®Ø¨Ø±Ø©</section>

  <!-- Weather + Prayer Times -->
  <section class="weather-box">
    <h3>ğŸŒ¦ï¸ Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù‚Ø³ ÙÙŠ Ù…Ø¯Ù†ÙŠÙ†</h3>
    <div style="display:flex; justify-content:space-between; align-items:flex-start;">
      <div>
        <div class="weather-temp" id="weather-temp">--Â°C</div>
        <div class="weather-desc" id="weather-desc">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
      </div>
      <div class="prayer-times" id="prayer-times">
        <p>ğŸŒ… Ø§Ù„ÙØ¬Ø±: --:--</p>
        <p>ğŸŒ„ Ø§Ù„Ø´Ø±ÙˆÙ‚: --:--</p>
        <p>â˜€ï¸ Ø§Ù„Ø¸Ù‡Ø±: --:--</p>
        <p>ğŸ•°ï¸ Ø§Ù„Ø¹ØµØ±: --:--</p>
        <p>ğŸŒ‡ Ø§Ù„Ù…ØºØ±Ø¨: --:--</p>
        <p>ğŸŒ™ Ø§Ù„Ø¹Ø´Ø§Ø¡: --:--</p>
      </div>
    </div>
  </section>

  <!-- Ratings -->
  <div class="rating-container">
    <p id="rating-title">Ù‚ÙŠÙ… Ø§Ù„ÙˆØ±Ø´Ø©:</p>
    <div class="stars-horizontal">
      <span data-value="5">â˜†</span>
      <span data-value="4">â˜†</span>
      <span data-value="3">â˜†</span>
      <span data-value="2">â˜†</span>
      <span data-value="1">â˜†</span>
    </div>
    <p id="rating-value">0/5</p>
  </div>

  <!-- Services Today -->
  <section class="services-today">
    <h2>Ø®Ø¯Ù…Ø§Øª Ø§Ù„ÙŠÙˆÙ…</h2>
    <div class="services-slider" id="servicesSlider">
      <div class="service-card">
        <img src="service1.webp" alt="">
        <p class="service-caption">ØªØµÙ„ÙŠØ­ Ù„ÙˆØ­Ø§Øª Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©</p>
      </div>
      <div class="service-card">
        <img src="service2.webp" alt="">
        <p class="service-caption">ØªØµÙ„ÙŠØ­ ÙƒØ§Ø±Øª Ø¬Ù‡Ø§Ø² Ø§Ù„Ù…Ø´ÙŠ</p>
      </div>
      <div class="service-card">
        <img src="service3.webp" alt="">
        <p class="service-caption">ØªØµÙ„ÙŠØ­ ÙƒØ§Ø±Øª ØºØ³Ø§Ù„Ø©</p>
      </div>
      <div class="service-card">
        <img src="service4.webp" alt="">
        <p class="service-caption">ØªØµÙ„ÙŠØ­ ÙƒØ§Ø±Øª ØªÙ„ÙØ§Ø²</p>
      </div>
      <div class="service-card">
        <img src="service5.webp" alt="">
        <p class="service-caption">ØªØµÙ„ÙŠØ­ ÙƒØ§Ø±Øª ØºØ³Ø§Ù„Ø© Ù„-Ø¬</p>
      </div>
    </div>
  </section>

  <!-- Video Today -->
  <section class="videos-today">
    <h2>ÙÙŠØ¯ÙŠÙˆ Ø§Ù„ÙŠÙˆÙ…</h2>
    <div class="services-slider" id="videoSlider">
      <div class="service-card video-card">
        <video src="video1.mp4" muted loop playsinline></video>
        <p class="service-caption">ØªØµÙ„ÙŠØ­ ÙƒØ§Ø±Øª ØªØºØ°ÙŠØ©</p>
      </div>
      <div class="service-card video-card">
        <video src="video2.mp4" muted loop playsinline></video>
        <p class="service-caption">Ø¥ØµÙ„Ø§Ø­ Ù„ÙˆØ­Ø© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©</p>
      </div>
      <div class="service-card video-card">
        <video src="video3.mp4" muted loop playsinline></video>
        <p class="service-caption">ÙØ­Øµ Ø¨ÙˆØ±Ø¯Ø© 1</p>
      </div>
      <div class="service-card video-card">
        <video src="video4.mp4" muted loop playsinline></video>
        <p class="service-caption">ÙØ­Øµ Ø¨ÙˆØ±Ø¯Ø© 2</p>
      </div>
      <div class="service-card video-card">
        <video src="video5.mp4" muted loop playsinline></video>
        <p class="service-caption">ÙØ­Øµ Ø¨ÙˆØ±Ø¯Ø© 3</p>
      </div>
    </div>
  </section>

</main>

<footer>
  &copy; <span id="year"></span> Atelier Electronique MÃ©denine. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.
  <div class="social-icons">
    <a href="#"><img src="facebook.svg" alt="Facebook"></a>
    <a href="#"><img src="instagram.svg" alt="Instagram"></a>
    <a href="#"><img src="youtube.svg" alt="YouTube"></a>
  </div>
</footer>

<script>
  // ======= Date & Time =======
  function updateTime() {
    const now = new Date();
    const timeStr = now.toLocaleTimeString('ar-TN', { hour12:false });
    document.getElementById('current-time').textContent = timeStr;
  }
  setInterval(updateTime, 1000);
  updateTime();

  // ======= Visitor Counter =======
  const visitsRef = db.ref('visits');
  visitsRef.transaction(current => (current||0)+1);
  visitsRef.on('value', snapshot => {
    document.getElementById('visit-count').textContent = "Ø¹Ø¯Ø¯ Ø²ÙˆØ§Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹: "+snapshot.val();
  });

  // ======= Firebase Auth =======
  const loginPopup = document.getElementById('login-popup');
  const btnGoogle = document.getElementById('btn-google');
  const btnClosePopup = document.getElementById('btn-close-popup');
  const userInfo = document.getElementById('user-info');
  const userNameSpan = document.getElementById('user-name');
  const btnSignOut = document.getElementById('btn-signout');

  btnGoogle.addEventListener('click', ()=> {
    const provider = new firebase.auth.GoogleAuthProvider();
    auth.signInWithPopup(provider).catch(err=>console.error(err));
  });

  btnClosePopup.addEventListener('click', ()=> loginPopup.style.display='none');

  auth.onAuthStateChanged(user=>{
    if(user){
      loginPopup.style.display='none';
      userInfo.style.display='flex';
      userNameSpan.textContent = user.displayName || user.email;
    }else{
      userInfo.style.display='none';
      loginPopup.style.display='flex';
    }
  });

  btnSignOut.addEventListener('click', ()=> auth.signOut());

  // ======= Weather + Prayer Times =======
  fetch("https://api.open-meteo.com/v1/forecast?latitude=33.35&longitude=10.52&current_weather=true")
  .then(r=>r.json()).then(data=>{
    document.getElementById('weather-temp').textContent = data.current_weather?.temperature+"Â°C"||"--Â°C";
    document.getElementById('weather-desc').textContent = data.current_weather?.weathercode || "ØºÙŠØ± Ù…ØªÙˆÙØ±";
  });

  fetch("https://api.aladhan.com/v1/timingsByCity?city=Medinine&country=Tunisia&method=2")
  .then(r=>r.json()).then(data=>{
    const times = data.data.timings;
    const pTags = document.querySelectorAll('#prayer-times p');
    const keys = ["Fajr","Sunrise","Dhuhr","Asr","Maghrib","Isha"];
    keys.forEach((k,i)=> pTags[i].innerHTML = `${pTags[i].textContent.split(':')[0]} <span class="time">${times[k]}</span>`);
  });

  // ======= Ratings =======
  const stars = document.querySelectorAll('.stars-horizontal span');
  const ratingValue = document.getElementById('rating-value');
  let currentRating = 0;

  stars.forEach(star=>{
    star.addEventListener('mouseover',()=> updateHover(star.dataset.value));
    star.addEventListener('mouseout',()=> updateHover(currentRating));
    star.addEventListener('click',()=> { currentRating=star.dataset.value; localStorage.setItem('rating',currentRating); updateHover(currentRating); });
  });

  function updateHover(value){
    stars.forEach(s=> {
      s.classList.remove('hover','selected');
      if(s.dataset.value <= value) s.classList.add('hover');
    });
    ratingValue.textContent = `${value}/5`;
  }

  const savedRating = localStorage.getItem('rating');
  if(savedRating) currentRating=savedRating;
  updateHover(currentRating);

  // ======= Services Slider Drag =======
  const sliders = document.querySelectorAll('.services-slider');
  sliders.forEach(slider=>{
    let isDown=false,startX,scrollLeft;
    slider.addEventListener('mousedown',e=>{
      isDown=true; slider.classList.add('active'); startX=e.pageX-slider.offsetLeft; scrollLeft=slider.scrollLeft;
    });
    slider.addEventListener('mouseleave',()=>isDown=false);
    slider.addEventListener('mouseup',()=>isDown=false);
    slider.addEventListener('mousemove',e=>{
      if(!isDown) return;
      e.preventDefault();
      const x=e.pageX-slider.offsetLeft;
      const walk=(x-startX)*2;
      slider.scrollLeft=scrollLeft-walk;
    });
  });

  // ======= Dynamic Year =======
  document.getElementById('year').textContent = new Date().getFullYear();

</script>

</body>
</html>
